import random

# public key, all device same
pub = b''.join([
    b'\x04\x50\xD9\x34\xFA\x67\xBC\xF6\xF2\xDF\xBF\x96\x62\x9E\x0A\x72',
    b'\x38\xE9\x20\x5D\x75\xF2\x8C\xFC\xD8\x4F\x35\xA6\x59\x2B\xBE\x05',
    b'\x8A\x9C\x0F\x8E\xDB\xCA\x2A\xCB\x67\xEF\xB7\x74\x97\x1C\xA4\x5F',
    b'\x7D\x85\x6A\x69\x4F\xB1\xB9\xC4\x0B\x94\xFB\x2E\x7A\x5A\x94\x98',
    b'\xB0'])

# key, iv, pub, rand
keys = [
    (
        bytes.fromhex('442b139ff63f7c4bcbd2c0cd579bf1eea19e892472a8b7f9a08e0e2fc98a55ca'),
        bytes.fromhex('f3315c156e2d58725d0aafd0'),
        pub,
        b''.join([
            b'\x04\xD6\x65\x09\xAE\x95\x8E\x95\x26\x18\x48\x8A\xA4\xBC\x3E\xA8',
            b'\x60\x44\xA2\xA3\xBF\xA0\x01\xEC\x97\x9B\x29\xEE\xA4\xB4\x64\x5E',
            b'\x84\xFE\x25\x08\x92\x6F\x04\x53\xCD\xC2\xAC\x4A\xF5\xA3\x22\x1D',
            b'\x68\xC7\x88\x79\x56\x80\x8E\xE3\xB5\x89\x02\xB7\xE2\x62\x74\xD6',
            b'\xD7'])
    )
]

def rand_key():
    #return random.choice(keys) # TODO: more
    return keys[0]

def get_device_cer():
    # Baller device iphone7 ? (iphone9,3)
    return bytes.fromhex('2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494944556a434341766567417749424167494741592f374c7634444d416f4743437147534d343942414d434d464d784a7a416c42674e5642414d4d486b4a680d0a63326c6a494546306447567a64474630615739754946567a5a5849675533566949454e424d5445544d424547413155454367774b51584277624755675357356a0d0a4c6a45544d424547413155454341774b5132467361575a76636d357059544165467730794e4441324d4467774e4441344d7a4a61467730794e54417a4d5449770d0a4f5455354d7a4a614d4947524d556b775277594456515144444541784d6a41784f4449315a6d45354d445a6a4e3246684f4751794f5449324e574978596a566c0d0a5957526b5a5464685a4455794e7a4531596d55324f47526b597a49794e6a52694d4467304d474e684e325a6a4e7a68684d526f77474159445651514c444246430d0a515545675132567964476c6d61574e6864476c76626a45544d424547413155454367774b51584277624755675357356a4c6a45544d424547413155454341774b0d0a5132467361575a76636d35705954425a4d424d4742797147534d34394167454743437147534d34394177454841304941424f752f585856546d32774c327042640d0a6f31707434717464694b596b3143734b556b546a34314654387937746d5a6b6a58697176677451487a53697550385a47304c4168784d734a4d6a614f482b74500d0a2f354738574f616a676746324d494942636a414d42674e5648524d4241663845416a41414d41344741315564447745422f7751454177494538444343415641470d0a43537147534962335932514b4151534341554545676745394d5949424f662b456b72326b5241737743525945516b39535241494244502b456d714753554130770d0a437859455130684a55414944414941512f3453716a5a4a45455441504667524651306c4541676359654f496b2b514d6d2f34615474634a6a477a415a466752690d0a6257466a4242466a4d44706b4d446f784d6a70684d44706b4d7a6f774e762b477937584b61526b77467859456157316c615151504d7a55314d7a49344d4467330d0a4e5459344e6a6b7a2f34656279647874466a41554667527a636d3574424178474d546455526a46574d5568484e30662f68367552306d51794d4441574248566b0d0a615751454b4459334e3256684d4463344d6d4e684d7a557a593255304d6d4a6b4d325532597a6c6b4e7a526c4d5467344f47466b595451794e546a2f683775310d0a776d4d624d426b574248647459574d4545574d774f6d51774f6a45794f6d45774f6d51794f6d45302f3465626c644a6b4f6a41344667527a5a576c6b424441770d0a4e4451794d6a45304d7a42434d3055344d4441784e6a4d774f5441784f4467354d546b7a4f546b774d454e444f544977517a46454d545a434d6a5178525545770d0a436759494b6f5a497a6a304541774944535141775267496841507a367635514634745439446472772b38307674776938476e6c2f4f682f616c62436c385977490d0a56724d534169454137676859526a38556c784f5471694c7a4658364f79635037486c6b644d392f3664542f3976596a654148453d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494943497a4343416169674177494241674949654e6a684739746e44476777436759494b6f5a497a6a304541774977557a456e4d43554741315545417777650d0a516d467a61574d67515852305a584e30595852706232346756584e6c636942536232393049454e424d524d77455159445651514b44417042634842735a53424a0d0a626d4d754d524d77455159445651514944417044595778705a6d3979626d6c684d423458445445334d4451794d4441774e4449774d466f5844544d794d444d790d0a4d6a41774d4441774d466f77557a456e4d4355474131554541777765516d467a61574d67515852305a584e30595852706232346756584e6c63694254645749670d0a513045784d524d77455159445651514b44417042634842735a53424a626d4d754d524d77455159445651514944417044595778705a6d3979626d6c684d466b770d0a457759484b6f5a497a6a3043415159494b6f5a497a6a304441516344516741456f535a2f31743965424145567035613850725861636d624762387a4e433158330d0a53744c4939594f365930434c37626c486d53476d6a475754774434512b69304a324259332b6250485447527941396a4742334d5362614e6d4d475177456759440d0a565230544151482f42416777426745422f7749424144416642674e5648534d45474441576742534435614d686e724230772f6c686b50325854694d516471536a0d0a386a416442674e564851344546675155356d57663144594c545855645139786d4f482f7571654e534438307744675944565230504151482f42415144416745470d0a4d416f4743437147534d343942414d4341326b414d4759434d5143334d3336304c4c744a5336305a39713376566a4a784d674d63465131726f475455634b71760d0a572b34684a3443654a6a795358546771364945486e2f7957616234434d51436d354e6e4b36534f534b2b417157756d396c4c383757334536414131663254764a0d0a2f68676f6b2f33346a7239336e68533837744f514e64784453387a796971773d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d')